
ch=128;
freqs=15;
ep=5;
f1=randn(freqs,1);f2=randn(freqs,1);
ch1=randn(ch,1);ch2=randn(ch,1);
ep1=randn(ep,1);ep2=randn(ep,1);
temp=tprod(f1,[1 -2],ch1,[2 -2]);
S1=tprod(temp,[1 2 -3],ep1,[3 -3]);
temp=tprod(f2,[1 -2],ch2,[2 -2]);
S2=tprod(temp,[1 2 -3],ep2,[3 -3]);;

Y=S1+S2+.1*randn(freqs,ch,ep);

[Fp,Y,Ip,Exp,e,Rpen]=parafac_reg(Y,2,G,Alpha(a),Options,[0 0 0]);
figure,plot(Fp{1})
figure,plot(f1